(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98a9de5e"],{5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,s){var a=s("1d80"),i=s("5899"),h="["+i+"]",o=RegExp("^"+h+h+"*"),n=RegExp(h+h+"*$"),c=function(e){return function(t){var s=String(a(t));return 1&e&&(s=s.replace(o,"")),2&e&&(s=s.replace(n,"")),s}};e.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(e,t,s){var a=s("861d"),i=s("d2bb");e.exports=function(e,t,s){var h,o;return i&&"function"==typeof(h=t.constructor)&&h!==s&&a(o=h.prototype)&&o!==s.prototype&&i(e,o),e}},"762e":function(e,t,s){"use strict";var a=s("c8f9"),i=s.n(a);i.a},"87af":function(e,t,s){e.exports=s.p+"img/seat_icon_checked_draw.606e17d9.svg"},"9fb8":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warp"},[a("div",{staticStyle:{display:"none"}},[a("img",{ref:"iconDraw",attrs:{src:s("87af"),alt:"",sizes:"",srcset:"",id:"500"}}),a("img",{ref:"iconChecked",attrs:{src:s("c5c6"),alt:"",sizes:"",srcset:""}}),a("img",{ref:"iconShow",attrs:{src:s("cf41"),alt:"",sizes:"",srcset:"",id:"500"}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.miniMap.show,expression:"miniMap.show"}],ref:"miniMap",staticClass:"mini-map",style:{width:e.miniMap.width+"px",height:e.miniMap.height+"px"}},[a("div",{ref:"checkBox",staticClass:"checkBox",style:{width:e.checkBox.width+"px",height:e.checkBox.height+"px",top:e.checkBox.top+"px",left:e.checkBox.left+"px"}})]),a("div",{staticClass:"top"},[a("button",{on:{click:function(t){e.miniMap.show=!e.miniMap.show}}},[e._v("miniMap")]),a("span",[e._v("调整画布大小"+e._s(e.wheelNum))]),a("number-input",{attrs:{point:2,max:99999,placeholder:"请输入金额1213",input:e.updateInputNumberVal},model:{value:e.wheelMaxBackUp,callback:function(t){e.wheelMaxBackUp=e._n(t)},expression:"wheelMaxBackUp"}}),a("button",{on:{click:e.comfrimSizeChange}},[e._v("确认调整")])],1),a("div",{ref:"content",staticClass:"content"},[a("div",{ref:"svgWarp",staticClass:"svg-warp",class:{showCanvas:e.wheelNum>=e.wheelShow},domProps:{innerHTML:e._s(e.svg)}}),e._l(e.canvasList,(function(t,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.wheelNum>=e.wheelShow,expression:"wheelNum>=wheelShow"}],key:s,staticClass:"canvas-row"},e._l(t,(function(t,s){return a("canvas",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"canvasItem.show"}],key:s,staticClass:"my-canvas",style:{left:t.left+"px",top:t.top+"px"},attrs:{id:t.canvasId}},[e._v("浏览器不支持canvas")])})),0)})),a("div",{directives:[{name:"show",rawName:"v-show",value:e.hoverInfo.show,expression:"hoverInfo.show"}],staticClass:"hover-info",style:{left:e.hoverInfo.left+"px",top:e.hoverInfo.top+"px"}},[a("span",[e._v(e._s(e.hoverInfo.text))]),a("div")])],2),a("div",{staticClass:"active-area"},[e._v("active-area")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.checkedShapeShow,expression:"checkedShapeShow"}],staticClass:"pop"},[a("div",{staticClass:"pop-content"},[a("h4",[a("span",[e._v("行：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShape.rows,expression:"checkedShape.rows",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShape.rows},on:{input:function(t){t.target.composing||e.$set(e.checkedShape,"rows",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("列：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShape.cols,expression:"checkedShape.cols",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShape.cols},on:{input:function(t){t.target.composing||e.$set(e.checkedShape,"cols",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("排座-起始行：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShape.startRow,expression:"checkedShape.startRow",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShape.startRow},on:{input:function(t){t.target.composing||e.$set(e.checkedShape,"startRow",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("排座-起始列（座）：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShape.startCol,expression:"checkedShape.startCol",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShape.startCol},on:{input:function(t){t.target.composing||e.$set(e.checkedShape,"startCol",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("横向排序方向：")]),a("em",{staticClass:"radio",class:{checked:0==e.checkedShape.orderRow},on:{click:function(t){e.checkedShape.orderRow=0}}},[e._v("逆时针")]),a("em",{staticClass:"radio",class:{checked:1==e.checkedShape.orderRow},on:{click:function(t){e.checkedShape.orderRow=1}}},[e._v("顺时针")])]),a("h4",[a("span",[e._v("竖直排序方向：")]),a("em",{staticClass:"radio",class:{checked:0==e.checkedShape.orderCol},on:{click:function(t){e.checkedShape.orderCol=0}}},[e._v("由里向外")]),a("em",{staticClass:"radio",class:{checked:1==e.checkedShape.orderCol},on:{click:function(t){e.checkedShape.orderCol=1}}},[e._v("由外向里")])]),a("h4",[a("button",{on:{click:e.checkedShapeSeatComfrim}},[e._v("确认")]),a("button",{on:{click:e.checkedShapeSeatCancle}},[e._v("取消")])])])])])},i=[],h=(s("cb29"),s("4160"),s("c975"),s("d81d"),s("ac1f"),s("1276"),s("159b"),s("5530")),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.inputModel,expression:"inputModel",modifiers:{number:!0}}],staticClass:"my-number-input",attrs:{type:"number",placeholder:e.placeholder},domProps:{value:e.inputModel},on:{input:function(t){t.target.composing||(e.inputModel=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})},n=[],c=(s("a9e3"),{components:{},props:{point:{default:0},max:Number,placeholder:String,value:{default:null}},computed:{inputModel:{get:function(){return this.value},set:function(e){var t=this.$el.value,s=t.length;if(2==s&&0==t.charAt(0)&&"."!=t.charAt(1))return this.$el.value=t.charAt(1),void this.setParentModeVal(this.$el.value);if(Math.abs(this.value)>0&&""===t&&""===e)return this.keyDownDel?(this.$el.value="",console.log("---正常删除---"+this.value)):(this.$el.value=this.value,console.log("---多次输入小数点---"+this.value)),void this.setParentModeVal(this.$el.value);if(""===this.value&&""===t&&""===e)return console.log("---22aa---"+this.value),this.$el.value="",void this.setParentModeVal("");if(t){var a=t.indexOf(".");if(0==this.point&&2==s&&"."==t.charAt(a))return console.log("只能输入整数"),this.$el.value=t.substr(0,a),void this.setParentModeVal(this.$el.value);if(a>0&&s-a>this.point+1)return console.log("只能输入"+this.point+"位小数"),this.$el.value=t.substr(0,a+this.point+1),void this.setParentModeVal(this.$el.value)}if(this.max>0&&t>this.max)return this.$el.value=t.substr(0,s-1),void this.setParentModeVal(this.$el.value);this.setParentModeVal(t)}}},data:function(){return{keyDownDel:!1}},mounted:function(){var e=this;window.document.onkeydown=function(t){var s=t||window.event||arguments.callee.caller.arguments[0];8==s.keyCode||46==s.keyCode?e.keyDownDel=!0:e.keyDownDel=!1}},methods:{setParentModeVal:function(e){this.$emit("input",e)}}}),r=c,l=s("2877"),d=Object(l["a"])(r,o,n,!1,null,null,null),p=d.exports,v=s("b893"),u=s("cf45"),f=null,w=null,g=null,m=null,S={name:"",components:{NumberInput:p},data:function(){return{pageVisible:!0,errorRange:50,hoverInfo:{show:!0,text:"3213",top:0,left:0},canvasSplit:{row:7,col:7},canvasList:[],wheelMaxBackUp:0,wheelMax:1,scaleMax:1.5,wheelNum:0,wheelMin:0,center:{find:!1,x:0,y:0},canvas:{left:0,top:0},svg:"",checkedSvg:"",maxWidth:0,maxHeight:0,setWidth:0,setHeight:0,position:{left:0,top:0},cont:{width:0,height:0,offsetLeft:0,offsetTop:0,center:[]},miniMap:{show:!0,width:0,height:0},checkBox:{width:0,height:0,top:0,left:0},seatIcon:{iconShow:"",iconChecked:"",iconDraw:"",width:0,height:0,marginRight:0,marginBottom:0,diagonalLine:0,realWidth:25,realHeight:25,realMarginRight:8,realMarginBottom:8},checkedShapeShow:!1,checkedShape:{shapeId:null,rows:0,cols:0,startRow:0,startCol:0,orderRow:0,orderCol:0},shapeList:[],renderList:[],viewBoxList:[],checkedSeatList:[]}},computed:{wheelPow:function(){var e=this.wheelNum*this.scaleMax;return e},wheelShow:function(){return Math.floor(.6*this.wheelMax*100)/100},wheelRadio:function(){this.wheelNum,this.wheelMax;return this.wheelNum/this.wheelMax}},watch:{position:{handler:function(e){if(g.style.left=e.left+"px",g.style.top=e.top+"px",this.wheelNum<this.wheelShow)return!1;this.canvasList.forEach((function(t,s){t.forEach((function(t,a){t.left=e.left+a*t.width,t.top=e.top+s*t.height}))}))},deep:!0},viewBoxList:{handler:function(e,t){for(var s=this,a=0;a<this.canvasSplit.row;a++){this.canvasList[a];for(var i=function(t){var i=s.canvasList[a][t],h=i.width*t-s.errorRange,o=i.width*(t+1)+s.errorRange,n=i.height*a-s.errorRange,c=i.height*(a+1)+s.errorRange,r=!1;e.forEach((function(e){var t=[e.cenPoint[0],e.cenPoint[1]],a=(e.angle,(s.seatIcon.width+s.seatIcon.marginRight)*e.cols-s.seatIcon.marginRight),l=(s.seatIcon.height+s.seatIcon.marginBottom)*e.rows-s.seatIcon.marginBottom,d=[t[0]-a/2,t[1]-l/2],p=[t[0]+a/2,t[1]-l/2],v=[t[0]+a/2,t[1]+l/2],u=[t[0]-a/2,t[1]+l/2],f=[t[0]*s.wheelPow,t[1]*s.wheelPow],w=[[d[0]*s.wheelPow,d[1]*s.wheelPow],[p[0]*s.wheelPow,p[1]*s.wheelPow],[v[0]*s.wheelPow,v[1]*s.wheelPow],[u[0]*s.wheelPow,u[1]*s.wheelPow]];if(f[0]>=h&&f[0]<=o&&f[1]>=n&&f[1]<=c)r=!0;else for(var g=0;g<4;g++){var m=w[g];if(m[0]>=h&&m[0]<=o&&m[1]>=n&&m[1]<=c){r=!0;break}}i.show=!!r}))},h=0;h<this.canvasSplit.col;h++)i(h)}},deep:!0}},created:function(){f=this,localStorage.getItem("shapeList")&&(this.shapeList=JSON.parse(localStorage.getItem("shapeList"))),localStorage.getItem("scaleMax")&&(this.scaleMax=parseFloat(localStorage.getItem("scaleMax"))),this.wheelMaxBackUp=this.scaleMax,this.calcSeatIconBaseData(this.scaleMax)},mounted:function(){var e=this;this.svg=_svg,this.$nextTick((function(){e.svgInit(),e.seatIconInit()}))},beforeDestroy:function(){},methods:{updateInputNumberVal:function(e){this.wheelMaxBackUp=e},calcSeatIconBaseData:function(e){this.seatIcon.width=this.seatIcon.realWidth/e,this.seatIcon.height=this.seatIcon.realHeight/e,this.seatIcon.marginRight=this.seatIcon.realMarginRight/e,this.seatIcon.marginBottom=this.seatIcon.realMarginBottom/e,this.seatIcon.diagonalLine=Math.pow(this.seatIcon.width/2*(this.seatIcon.width/2)*2,.5)},calcSvgCanvasBaseData:function(e){this.maxWidth=2*this.center.x*e,this.maxHeight=2*this.center.y*e,this.wheelMin=this.floatTwo(this.cont.width/this.maxWidth),this.canvasSplit.col=Math.ceil(this.maxWidth/2e3),this.canvasSplit.row=Math.ceil(this.maxHeight/2e3),this.canvasInit()},comfrimSizeChange:function(){var e=this;if(null===this.checkedShape.shapeId)return alert("请先双击选择需要观察的图形"),!1;this.scaleMax=this.wheelMaxBackUp,localStorage.setItem("scaleMax",this.scaleMax),this.calcSeatIconBaseData(this.scaleMax),this.calcSvgCanvasBaseData(this.scaleMax),this.$nextTick((function(){return e.clickToMax(e.checkedShape,e.wheelNum<e.wheelShow?e.wheelShow:e.wheelNum)}))},canvasInit:function(){var e=this;this.canvasList=[];for(var t=[],s={dom:null,ctx:null,width:0,height:0,left:0,top:0,show:!1},a=1,i=0;i<this.canvasSplit.row;i++){for(var o=[],n=0;n<this.canvasSplit.col;n++)o.push(Object(h["a"])({},s,{canvasId:a})),a++;t.push(o)}this.canvasList=t,this.$nextTick((function(){var t=document.getElementsByTagName("canvas");e.canvasList.forEach((function(s,a){s.forEach((function(s,i){s.dom=t[e.canvasSplit.col*a+i],s.ctx=t[e.canvasSplit.col*a+i].getContext("2d")}))}))}))},checkOnSeat:function(e,t){for(var s=[e.cenPoint[0]*this.wheelPow,e.cenPoint[1]*this.wheelPow],a=((this.seatIcon.width+this.seatIcon.marginRight)*e.cols-this.seatIcon.marginRight)*this.wheelPow,i=((this.seatIcon.height+this.seatIcon.marginBottom)*e.rows-this.seatIcon.marginBottom)*this.wheelPow,h=[s[0]-a/2,s[1]-i/2],o=[],n=0;n<e.cols;n++)for(var c=h[0]+(n*(this.seatIcon.width+this.seatIcon.marginRight)+this.seatIcon.width/2)*this.wheelPow,r=0;r<e.rows;r++){var l=h[1]+(r*(this.seatIcon.height+this.seatIcon.marginBottom)+this.seatIcon.height/2)*this.wheelPow,d=v["a"].rotatePoint(s,[c,l],-e.angle),p=v["a"].getDisance1(d,t);if(p<this.seatIcon.diagonalLine*this.wheelPow){o=[r,n];break}if(0!=o.length)break}return o},svgInit:function(){var e=this;g=this.$refs.svgWarp,m=g.firstElementChild;var t=this.shapeList.map((function(e){return e.shapeId})),s=m.childNodes,a=0;s.forEach((function(s){if(1==s.nodeType&&"text"!=s.nodeName&&"title"!=s.nodeName){var i=++a;s.setAttribute("id",i);var h=t.indexOf(i+"");-1!=h&&e.shapeList[h].rows>0&&e.shapeList[h].cols>0&&(s.style.fill="rgba(255, 192, 203, 0.74)")}}));var i=m.getAttribute("viewBox").split(" ");this.center={find:!0,x:parseFloat(i[2])/2,y:parseFloat(i[3])/2},this.warpInit(),this.calcSvgCanvasBaseData(this.scaleMax),this.setSvgAndCanvas(this.wheelMin),this.setCheckBox(),document.getElementById("210").setAttribute("cx",this.center.x),document.getElementById("210").setAttribute("cy",this.center.y)},clickToMax:function(e,t){this.setSvgAndCanvas(t);var s=e.cenPoint,a=s[0]*this.wheelPow-this.cont.width/2,i=s[1]*this.wheelPow-this.cont.height/2,h={top:-1*i,left:-1*a};this.positionCheck(h),this.setCheckBox()},updateShapeSeatStatus:function(e,t){for(var s=this,a=[e.cenPoint[0],e.cenPoint[1]],i=e.angle,o=((this.seatIcon.width+this.seatIcon.marginRight)*e.cols-this.seatIcon.marginRight)*this.wheelPow,n=((this.seatIcon.height+this.seatIcon.marginBottom)*e.rows-this.seatIcon.marginBottom)*this.wheelPow,c=[a[0]*this.wheelPow-o/2,a[1]*this.wheelPow-n/2],r=[a[0]*this.wheelPow+o/2,a[1]*this.wheelPow-n/2],l=[a[0]*this.wheelPow+o/2,a[1]*this.wheelPow+n/2],d=[a[0]*this.wheelPow-o/2,a[1]*this.wheelPow+n/2],p=[a[0]*this.wheelPow,a[1]*this.wheelPow],v=[[c[0],c[1]],[r[0],r[1]],[l[0],l[1]],[d[0],d[1]]],u=[],f=0;f<this.canvasSplit.row;f++){this.canvasList[f];for(var w=0;w<this.canvasSplit.col;w++){var g=this.canvasList[f][w],m=g.width*w-this.errorRange,S=g.width*(w+1)+this.errorRange,k=g.height*f-this.errorRange,C=g.height*(f+1)+this.errorRange;if(p[0]>=m&&p[0]<=S&&p[1]>=k&&p[1]<=C)u.push(Object(h["a"])({col:w,row:f},g));else for(var x=0;x<v.length;x++){var I=v[x];if(I[0]>=m&&I[0]<=S&&I[1]>=k&&I[1]<=C){u.push(Object(h["a"])({col:w,row:f},g));break}}}}u.forEach((function(a){a.ctx.save();var h=p[0]-a.col*a.width,o=p[1]-a.row*a.height;a.ctx.translate(h,o),a.ctx.rotate(i*Math.PI/180),a.ctx.translate(-h,-o),t.forEach((function(t){var i=t[0],h=t[1],o=c[0]+h*(s.seatIcon.width+s.seatIcon.marginRight)*s.wheelPow,n=c[1]+i*(s.seatIcon.height+s.seatIcon.marginBottom)*s.wheelPow,r=o-a.col*a.width,l=n-a.row*a.height;0==e.seats[i][h].status?(a.ctx.beginPath(),a.ctx.drawImage(s.seatIcon.iconShow,r,l,s.seatIcon.width*s.wheelPow,s.seatIcon.height*s.wheelPow)):1==e.seats[i][h].status&&(a.ctx.beginPath(),a.ctx.drawImage(s.seatIcon.iconChecked,r,l,s.seatIcon.width*s.wheelPow,s.seatIcon.height*s.wheelPow),a.ctx.drawImage(s.seatIcon.iconDraw,r,l,s.seatIcon.width*s.wheelPow,s.seatIcon.height*s.wheelPow))})),a.ctx.restore()}))},drawOneShapeSeat:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[e.cenPoint[0],e.cenPoint[1]],i=e.angle;if(s)if(e.cols==s.cols&&e.rows==s.rows);else{var o=(this.seatIcon.width+this.seatIcon.marginRight)*s.cols-this.seatIcon.marginRight,n=(this.seatIcon.height+this.seatIcon.marginBottom)*s.rows-this.seatIcon.marginBottom,c=[a[0]-o/2,a[1]-n/2],r=[a[0]+o/2,a[1]-n/2],l=[a[0]+o/2,a[1]+n/2],d=[a[0]-o/2,a[1]+n/2],p=[[c[0]*this.wheelPow,c[1]*this.wheelPow],[r[0]*this.wheelPow,r[1]*this.wheelPow],[l[0]*this.wheelPow,l[1]*this.wheelPow],[d[0]*this.wheelPow,d[1]*this.wheelPow]],v=[];this.canvasList.forEach((function(e,s){e.forEach((function(e,a){for(var i=e.width*a-t.errorRange,o=e.width*(a+1)+t.errorRange,n=e.height*s-t.errorRange,c=e.height*(s+1)+t.errorRange,r=0;r<4;r++){var l=p[r];if(l[0]>=i&&l[0]<=o&&l[1]>=n&&l[1]<=c){v.push(Object(h["a"])({col:a,row:s},e));break}}}))})),v.forEach((function(e){e.ctx.save(),e.ctx.translate(a[0]*t.wheelPow-e.col*e.width,a[1]*t.wheelPow-e.row*e.height),e.ctx.rotate(i*Math.PI/180),e.ctx.translate(-(a[0]*t.wheelPow-e.col*e.width),-(a[1]*t.wheelPow-e.row*e.height)),e.ctx.clearRect(c[0]*t.wheelPow-e.col*e.width,c[1]*t.wheelPow-e.row*e.height,o*t.wheelPow,n*t.wheelPow),e.ctx.restore()}))}for(var u=((this.seatIcon.width+this.seatIcon.marginRight)*e.cols-this.seatIcon.marginRight)*this.wheelPow,f=((this.seatIcon.height+this.seatIcon.marginBottom)*e.rows-this.seatIcon.marginBottom)*this.wheelPow,w=[a[0]*this.wheelPow-u/2,a[1]*this.wheelPow-f/2],g=[a[0]*this.wheelPow+u/2,a[1]*this.wheelPow-f/2],m=[a[0]*this.wheelPow+u/2,a[1]*this.wheelPow+f/2],S=[a[0]*this.wheelPow-u/2,a[1]*this.wheelPow+f/2],k=[a[0]*this.wheelPow,a[1]*this.wheelPow],C=[[w[0],w[1]],[g[0],g[1]],[m[0],m[1]],[S[0],S[1]]],x=[],I=0;I<this.canvasSplit.row;I++){this.canvasList[I];for(var b=0;b<this.canvasSplit.col;b++){var P=this.canvasList[I][b],L=P.width*b-this.errorRange,B=P.width*(b+1)+this.errorRange,M=P.height*I-this.errorRange,y=P.height*(I+1)+this.errorRange;if(k[0]>=L&&k[0]<=B&&k[1]>=M&&k[1]<=y)x.push(Object(h["a"])({col:b,row:I},P));else for(var N=0;N<C.length;N++){var R=C[N];if(R[0]>=L&&R[0]<=B&&R[1]>=M&&R[1]<=y){x.push(Object(h["a"])({col:b,row:I},P));break}}}}x.forEach((function(s){s.ctx.save();var a=k[0]-s.col*s.width,h=k[1]-s.row*s.height;s.ctx.translate(a,h),s.ctx.rotate(i*Math.PI/180),s.ctx.translate(-a,-h);for(var o=0;o<e.cols;o++)for(var n=w[0]+o*(t.seatIcon.width+t.seatIcon.marginRight)*t.wheelPow,c=n-s.col*s.width,r=0;r<e.rows;r++){var l=w[1]+r*(t.seatIcon.height+t.seatIcon.marginBottom)*t.wheelPow,d=l-s.row*s.height;0==e.seats[r][o].status?(s.ctx.beginPath(),s.ctx.drawImage(t.seatIcon.iconShow,c,d,t.seatIcon.width*t.wheelPow,t.seatIcon.height*t.wheelPow)):1==e.seats[r][o].status&&(s.ctx.beginPath(),s.ctx.drawImage(t.seatIcon.iconChecked,c,d,t.seatIcon.width*t.wheelPow,t.seatIcon.height*t.wheelPow),s.ctx.drawImage(t.seatIcon.iconDraw,c,d,t.seatIcon.width*t.wheelPow,t.seatIcon.height*t.wheelPow))}s.ctx.restore()}))},drawMapSeat:function(e){var t=this;if(this.wheelNum<this.wheelShow)return!1;e.forEach((function(e,s){if(0==e.cols||0==e.rows)return!1;t.drawOneShapeSeat(e)}))},shapeCheckedAction:function(e,t){var s=e.nodeName;if("path"!=s&&"rect"!=s&&"polygon"!=s)return!1;var a=[],i=e.getAttribute("id"),o=this.shapeList.map((function(e){return e.shapeId}));if(-1==o.indexOf(i))return!1;var n=o.indexOf(i);if(a=JSON.parse(JSON.stringify(this.shapeList[n])),a.shapeId==this.checkedShape.shapeId)if(this.wheelNum<this.wheelShow)this.clickToMax(a,this.wheelNum<this.wheelShow?this.wheelShow:this.wheelNum);else{var c=this.checkOnSeat(a,t);if(0!=c.length){var r=a.seats[c[0]][c[1]];if(-1==r.status)return!1;if(0==r.status)r.status=1,this.checkedSeatList.push(Object(h["a"])({},r));else if(1==r.status){r.status=0;var l=this.checkedSeatList.map((function(e){return e.seatId}));this.$delete(this.checkedSeatList,l.indexOf(r.seatId))}this.shapeList[n].seats[c[0]][c[1]].status=r.status,this.updateShapeSeatStatus(this.shapeList[n],[c])}}else this.clickToMax(a,this.wheelNum<this.wheelShow?this.wheelShow:this.wheelNum),this.toggleCheckedShapeStatus(a,Object(h["a"])({},this.checkedShape)),this.checkedShape=a},getDisplayAreaShapeIds:function(){var e;if(this.wheelNum<this.wheelShow)return!1;for(var t=-this.position.left/this.wheelPow+this.center.x/200,s=(-this.position.left+this.cont.width)/this.wheelPow-this.center.x/200,a=-this.position.top/this.wheelPow+this.center.x/200,i=(-this.position.top+this.cont.height)/this.wheelPow-this.center.x/200,o=[],n=this.renderList.map((function(e){return e.shapeId})),c=0;c<this.shapeList.length;c++){var r=this.shapeList[c];if(-1==n.indexOf(r.shapeId))if(r.cenPoint[0]<s&&r.cenPoint[0]>t&&r.cenPoint[1]<i&&r.cenPoint[1]>a)o.push(r);else for(var l=0;l<r.pointList.length;l++){var d=r.pointList[l];if(d[0]<s&&d[0]>t&&d[1]<i&&d[1]>a){o.push(r);break}}}(e=this.renderList).push.apply(e,o),this.drawMapSeat(o);for(var p=[],v=0;v<this.shapeList.length;v++){var f=this.shapeList[v];if(f.cenPoint[0]<s&&f.cenPoint[0]>t&&f.cenPoint[1]<i&&f.cenPoint[1]>a)p.push(f);else for(var w=0;w<f.pointList.length;w++){var g=f.pointList[w];if(g[0]<s&&g[0]>t&&g[1]<i&&g[1]>a){p.push(f);break}}}u["a"].diffObject(Object(h["a"])({},this.viewBoxList),Object(h["a"])({},p))||(this.viewBoxList=p)},toggleCheckedShapeStatus:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&t.shapeId){if(e.shapeId==t.shapeId)return!1;document.getElementById(t.shapeId).style.stroke="#333",document.getElementById(t.shapeId).style.strokeWidth=1}document.getElementById(e.shapeId).style.strokeWidth=6,document.getElementById(e.shapeId).style.stroke="green",document.getElementById("500").setAttribute("style","transform: rotate("+e.angle+"deg);transform-origin: 50% 50%;")},checkedShapeSeatComfrim:function(){this.checkedShapeShow=!1,this.saveAction();var e=Object(h["a"])({},this.checkedShape),t=0;if(e.seats=[],0==e.orderRow)for(var s=0;s<e.rows;s++){var a=[];if(0==e.orderCol)for(var i=0;i<e.cols;i++){var o={seatId:e.shapeId+t++,status:0,rowString:e.startRow+s,colString:e.startCol+i,level:0};a.push(o)}else for(var n=e.cols-1;n>-1;n--){var c={seatId:e.shapeId+t++,status:0,rowString:e.startRow+s,colString:e.startCol+n,level:0};a.push(c)}e.seats.push(a)}else for(var r=e.rows-1;r>-1;r--){var l=[];if(0==e.orderCol)for(var d=0;d<e.cols;d++){var p={seatId:e.shapeId+t++,status:0,rowString:e.startRow+r,colString:e.startCol+d,level:0};l.push(p)}else for(var v=e.cols-1;v>-1;v--){var u={seatId:e.shapeId+t++,status:0,rowString:e.startRow+r,colString:e.startCol+v,level:0};l.push(u)}e.seats.push(l)}var f=e.shapeId,w=this.shapeList.map((function(e){return e.shapeId})),g=w.indexOf(f);-1!=g&&(this.drawOneShapeSeat(Object(h["a"])({},e),Object(h["a"])({},this.shapeList[g])),this.$set(this.shapeList,g,Object(h["a"])({},e)));var m=this.renderList.map((function(e){return e.shapeId})),S=m.indexOf(f);-1!=S?this.$set(this.renderList,S,Object(h["a"])({},e)):this.renderList.push(Object(h["a"])({},e)),this.viewBoxList.push(Object(h["a"])({},e)),document.getElementById(e.shapeId).style.fill="rgba(255, 192, 203, 0.74)",this.saveAction()},checkedShapeSeatCancle:function(){console.log("checkedShapeSeatCancle.........."),this.checkedShapeShow=!1},setSvgAndCanvas:function(e){var t=this;this.wheelNum=e,this.setWidth=this.wheelNum*this.maxWidth,this.setHeight=this.wheelNum*this.maxHeight,m.setAttribute("width",this.setWidth),m.setAttribute("height",this.setHeight),this.wheelNum>=this.wheelShow&&(this.canvasList.forEach((function(e,s){e.forEach((function(e){e.width=t.setWidth/t.canvasSplit.col,e.height=t.setHeight/t.canvasSplit.row,e.dom.width=t.setWidth/t.canvasSplit.col,e.dom.height=t.setHeight/t.canvasSplit.row}))})),this.$nextTick((function(){t.getDisplayAreaShapeIds()}))),this.renderList=[],this.viewBoxList=[]},setCheckBox:function(){this.checkBox.width=this.miniMap.width*this.wheelMin/this.wheelNum,this.checkBox.height=this.miniMap.height*this.wheelMin/this.wheelNum;var e=0,t=0;e=this.cont.width/2-this.position.left,t=this.cont.height/2-this.position.top,this.checkBox.left=e/this.setWidth*this.miniMap.width-this.checkBox.width/2,this.checkBox.top=t/this.setHeight*this.miniMap.height-this.checkBox.height/2},positionCheck:function(e){var t=this.cont.height-this.setHeight,s=this.cont.width-this.setWidth,a=-this.cont.height,i=-this.cont.width;e.top<0&&e.top<t?this.position.top=t:e.top>0&&e.top>a?this.position.top=0:this.position.top=e.top,e.left<0&&e.left<s?this.position.left=s:e.left>0&&e.left>i?this.position.left=0:this.position.left=e.left},warpInit:function(){w=this.$refs.content,this.cont.width=w.clientWidth||w.offsetWidth,this.cont.height=w.clientHeight||w.offsetHeight,this.cont.offsetLeft=w.offsetLeft,this.cont.offsetTop=w.offsetTop,this.cont.center=[this.cont.width/2+this.cont.offsetLeft,this.cont.height/2+this.cont.offsetTop],this.miniMap.width=300,this.miniMap.height=300*this.cont.height/this.cont.width,-1!=window.navigator.userAgent.toLowerCase().indexOf("firefox")?w.addEventListener?w.addEventListener("DOMMouseScroll",this.warpWheel,!1):w.attachEvent("onDOMMouseScroll",this.warpWheel):w.addEventListener?w.addEventListener("mousewheel",this.warpWheel,!1):w.attachEvent("onmousewheel",this.warpWheel),w.onmouseout=this.warpOut,w.onmousemove=this.warpHover,w.onmousedown=function(e){f.hoverInfoInit(),w.onmousemove=null,w.onmouseout=null;var t=e.clientX,s=e.clientY,a=g.offsetTop,i=g.offsetLeft,h=!1,o=e.target;w.onmousemove=function(e){var o=Math.ceil(e.clientX-t),n=Math.ceil(e.clientY-s);Math.abs(o)>=5&&Math.abs(n)>=5&&(h=!0,f.positionCheck({top:n+a,left:o+i}),f.setCheckBox())},w.onmouseup=function(e){f.hoverInfoInit(),w.onmousemove=f.warpHover,w.onmouseup=null,w.onmouseout=f.warpOut,h?f.getDisplayAreaShapeIds():f.shapeCheckedAction(o,[t-i-f.cont.offsetLeft,s-a-f.cont.offsetTop])}}},warpOut:function(){f.hoverInfoInit()},warpHover:function(e){if(this.wheelNum<this.wheelShow)return!1;var t=e.target,s=t.nodeName;if("path"!=s&&"rect"!=s&&"polygon"!=s)return!1;var a=e.clientX,i=e.clientY,h=[a-g.offsetLeft-f.cont.offsetLeft,i-g.offsetTop-f.cont.offsetTop],o=t.getAttribute("id"),n=this.viewBoxList.map((function(e){return e.shapeId})),c=n.indexOf(o);if(-1!=c){var r=this.viewBoxList[c],l=this.checkOnSeat(r,h);if(0==l.length)this.hoverInfoInit();else{var d=r.seats[l[0]][l[1]];-1==d.status?this.hoverInfoInit():(this.hoverInfo.text=d.rowString+"排 "+d.colString+"座",this.hoverInfo.show=!0,this.hoverInfo.top=i,this.hoverInfo.left=a)}}},warpWheel:function(e){this.hoverInfoInit();var t=g.offsetWidth,s=g.offsetHeight,a=g.offsetTop,i=g.offsetLeft,h=e.wheelDelta/12e3;(h<0&&this.wheelNum>this.wheelMax/4||h>0&&this.wheelNum<this.wheelMax/4*3)&&(h*=8);var o=this.floatTwo(this.wheelNum+h);if(this.wheelNum>=this.wheelMax&&o>this.wheelMax)return!1;if(this.wheelNum<=this.wheelMin&&o<this.wheelMin)return!1;o>=this.wheelMax?o=this.wheelMax:o<=this.wheelMin&&(o=this.wheelMin),this.setSvgAndCanvas(o);var n={top:0,left:0};if(o==this.wheelMin)n.top=0,n.left=0;else{var c=(e.clientY-a)/s,r=(e.clientX-i)/t;n.top=Math.ceil(e.clientY-this.setHeight*c),n.left=Math.ceil(e.clientX-this.setWidth*r)}this.positionCheck(n),this.setCheckBox()},hoverInfoInit:function(){this.hoverInfo.show=!1,this.hoverInfo.top=0,this.hoverInfo.left=0,this.hoverInfo.text=""},seatIconInit:function(){this.seatIcon.iconShow=this.$refs.iconShow,this.seatIcon.iconChecked=this.$refs.iconChecked,this.seatIcon.iconDraw=this.$refs.iconDraw},judgePageActive:function(){var e,t;"undefined"!==typeof document.hidden?("hidden",t="visibilitychange",e="visibilityState"):"undefined"!==typeof document.mozHidden?("mozHidden",t="mozvisibilitychange",e="mozVisibilityState"):"undefined"!==typeof document.msHidden?("msHidden",t="msvisibilitychange",e="msVisibilityState"):"undefined"!==typeof document.webkitHidden&&("webkitHidden",t="webkitvisibilitychange",e="webkitVisibilityState"),document.addEventListener(t,(function(){var t=this;if("hidden"==document[e]){console.log("hidden............");setTimeout((function(){t.pageVisible=!1}),1e4);document.title=document[e]}else console.log("visible............"),0==this.pageVisible&&(this.pageVisible=!0)}))},saveAction:function(){localStorage.setItem("shapeList",JSON.stringify(this.shapeList))},floatTwo:function(e){return Math.floor(1e4*e)/1e4}}},k=S,C=(s("762e"),Object(l["a"])(k,a,i,!1,null,"e479aa80",null));t["a"]=C.exports},a9e3:function(e,t,s){"use strict";var a=s("83ab"),i=s("da84"),h=s("94ca"),o=s("6eeb"),n=s("5135"),c=s("c6b6"),r=s("7156"),l=s("c04e"),d=s("d039"),p=s("7c73"),v=s("241c").f,u=s("06cf").f,f=s("9bf2").f,w=s("58a8").trim,g="Number",m=i[g],S=m.prototype,k=c(p(S))==g,C=function(e){var t,s,a,i,h,o,n,c,r=l(e,!1);if("string"==typeof r&&r.length>2)if(r=w(r),t=r.charCodeAt(0),43===t||45===t){if(s=r.charCodeAt(2),88===s||120===s)return NaN}else if(48===t){switch(r.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+r}for(h=r.slice(2),o=h.length,n=0;n<o;n++)if(c=h.charCodeAt(n),c<48||c>i)return NaN;return parseInt(h,a)}return+r};if(h(g,!m(" 0o1")||!m("0b1")||m("+0x1"))){for(var x,I=function(e){var t=arguments.length<1?0:e,s=this;return s instanceof I&&(k?d((function(){S.valueOf.call(s)})):c(s)!=g)?r(new m(C(t)),s,I):C(t)},b=a?v(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;b.length>P;P++)n(m,x=b[P])&&!n(I,x)&&f(I,x,u(m,x));I.prototype=S,S.constructor=I,o(i,g,I)}},c3b9:function(e,t,s){"use strict";var a=s("d1ad"),i=s.n(a);i.a},c3cf:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warp"},[a("div",{staticStyle:{display:"none"}},[a("img",{ref:"iconNone",attrs:{src:s("8be0"),alt:"",sizes:"",srcset:""}}),a("img",{ref:"iconSelected",attrs:{src:s("f1b0"),alt:"",sizes:"",srcset:""}}),a("img",{ref:"iconShow",attrs:{src:s("cf41"),alt:"",sizes:"",srcset:"",id:"500"}})]),a("div",{staticClass:"top clear"}),a("div",{staticClass:"bottom clear"},[a("div",{staticClass:"content-warp"},[a("div",{ref:"content",staticClass:"content"},[a("div",{ref:"svgWarp",staticClass:"svg-warp",domProps:{innerHTML:e._s(e.svg)}})])]),a("div",{ref:"activeArea",staticClass:"active-area"},[a("div",{staticClass:"active-top",style:{height:e.activeTop+"px"}},[a("p",[e._v("shapeId:"+e._s(e.checkedShape.shapeId)+" cols:"+e._s(e.checkedShape.cols)+" rows:"+e._s(e.checkedShape.rows)+" 横向排序方向："+e._s(0==e.checkedShape.orderRow?"逆时针":"顺时针")+" 竖直排序方向："+e._s(0==e.checkedShape.orderCol?"由里向外":"由外向里"))]),a("div",{staticClass:"btns"},[a("button",{on:{click:e.toChangeShapeInfo}},[e._v("修改区域座位信息")]),a("button",{attrs:{disabled:0==e.selectedSeatList.length},on:{click:e.addSeat}},[e._v("添加座位")]),a("button",{attrs:{disabled:0==e.selectedSeatList.length},on:{click:e.removeSeat}},[e._v("删除座位")]),a("button",{attrs:{disabled:0==e.selectedSeatList.length},on:{click:e.cancleSeleced}},[e._v("取消选择")])]),a("div",{staticClass:"cols-span",style:{left:e.activeLeft+e.seatCanvas.paddingLeft+e.seatCanvas.left+"px"},on:{mouseout:function(t){e.hoverPinkBox.width=0,e.hoverPinkBox.height=0}}},e._l(e.checkedShape.cols,(function(t,s){return a("span",{key:s,on:{click:function(t){return e.checkedRowsOrCols(s,!1)},mouseover:function(t){return e.hoverRowsOrCols(s,!1)}}},[e._v(e._s(e.checkedShape.startCol+s)+" 列")])})),0)]),a("div",{staticClass:"active-left",style:{width:e.activeLeft+"px",paddingTop:e.seatCanvas.paddingTop+"px"}},[a("div",{staticClass:"rows-span",style:{top:e.seatCanvas.paddingTop+e.seatCanvas.top+"px"},on:{mouseout:function(t){e.hoverPinkBox.width=0,e.hoverPinkBox.height=0}}},e._l(e.checkedShape.rows,(function(t,s){return a("span",{key:s,on:{click:function(t){return e.checkedRowsOrCols(s,!0)},mouseover:function(t){return e.hoverRowsOrCols(s,!0)}}},[e._v(e._s(e.checkedShape.startRow+s)+" 排")])})),0)]),a("div",{ref:"seatCanvasWarp",staticClass:"seat-canvas-warp"},[a("canvas",{directives:[{name:"show",rawName:"v-show",value:null!=e.checkedShape.shapeId,expression:"checkedShape.shapeId!=null"}],ref:"seatCanvas",staticClass:"seat-canvas",attrs:{id:"seatCanvas"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedBox.width>0&&e.selectedBox.height>0&&!e.checkedShapeShow,expression:"selectedBox.width>0&&selectedBox.height>0&&!checkedShapeShow"}],ref:"selectedBox",staticClass:"selected-box",style:{width:e.selectedBox.width+"px",height:e.selectedBox.height+"px",top:e.selectedBox.top+"px",left:e.selectedBox.left+"px"}},[e._v("selectedBox")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.hoverPinkBox.width,expression:"hoverPinkBox.width!=0"}],ref:"hoverPinkBox",staticClass:"hover-box",style:{width:e.hoverPinkBox.width+"px",height:e.hoverPinkBox.height+"px",top:e.hoverPinkBox.top+"px",left:e.hoverPinkBox.left+"px"}},[e._v("hoverPinkBox")]),a("div",{ref:"onlyForAction",staticClass:"only-for-action",style:{width:e.seatCanvas.width+"px",height:e.seatCanvas.height+"px"}})])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.checkedShapeShow,expression:"checkedShapeShow"}],staticClass:"pop"},[a("div",{staticClass:"pop-content"},[a("h4",[a("span",[e._v("行：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShapePopData.rows,expression:"checkedShapePopData.rows",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShapePopData.rows},on:{input:function(t){t.target.composing||e.$set(e.checkedShapePopData,"rows",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("列：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShapePopData.cols,expression:"checkedShapePopData.cols",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShapePopData.cols},on:{input:function(t){t.target.composing||e.$set(e.checkedShapePopData,"cols",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("排座-起始行：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShapePopData.startRow,expression:"checkedShapePopData.startRow",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShapePopData.startRow},on:{input:function(t){t.target.composing||e.$set(e.checkedShapePopData,"startRow",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("排座-起始列（座）：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.checkedShapePopData.startCol,expression:"checkedShapePopData.startCol",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.checkedShapePopData.startCol},on:{input:function(t){t.target.composing||e.$set(e.checkedShapePopData,"startCol",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("h4",[a("span",[e._v("横向排序方向：")]),a("em",{staticClass:"radio",class:{checked:0===e.checkedShapePopData.orderRow},on:{click:function(t){e.checkedShapePopData.orderRow=0}}},[e._v("逆时针")]),a("em",{staticClass:"radio",class:{checked:1===e.checkedShapePopData.orderRow},on:{click:function(t){e.checkedShapePopData.orderRow=1}}},[e._v("顺时针")])]),a("h4",[a("span",[e._v("竖直排序方向：")]),a("em",{staticClass:"radio",class:{checked:0===e.checkedShapePopData.orderCol},on:{click:function(t){e.checkedShapePopData.orderCol=0}}},[e._v("由里向外")]),a("em",{staticClass:"radio",class:{checked:1===e.checkedShapePopData.orderCol},on:{click:function(t){e.checkedShapePopData.orderCol=1}}},[e._v("由外向里")])]),a("h4",[a("button",{on:{click:e.checkedShapeSeatComfrim}},[e._v("确认")]),a("button",{on:{click:e.checkedShapeSeatCancle}},[e._v("取消")])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.hoverInfo.show,expression:"hoverInfo.show"}],staticClass:"hover-info",style:{left:e.hoverInfo.left+"px",top:e.hoverInfo.top+"px"}},[a("span",[e._v(e._s(e.hoverInfo.text))]),a("div")])])},i=[],h=(s("cb29"),s("4160"),s("c975"),s("d81d"),s("d3b7"),s("ac1f"),s("25f0"),s("1276"),s("159b"),s("2909")),o=s("5530"),n=s("b893"),c=(s("cf45"),null),r=null,l=null,d={name:"",components:{},data:function(){return{pageVisible:!0,seatCanvasWarp:{dom:null,offsetLeft:0,offsetTop:0},seatCanvas:{dom:"",ctx:null,width:0,height:0,paddingLeft:20,paddingTop:20,seatWdith:20,seatHeight:20,seatMarginRight:5,seatMarginBottom:5,top:0,left:0},selectCanvas:{dom:"",ctx:null},activeTop:100,activeLeft:50,selectedBox:{width:0,height:0,top:0,left:0},selectedSeatList:[],hoverPinkBox:{width:0,height:0,top:0,left:0},hoverInfo:{show:!1,text:"",top:0,left:0},center:{find:!1,x:0,y:0},svg:"",seatIcon:{iconShow:"",iconNone:"",width:20,height:20,marginRight:5,marginBottom:5},checkedShapeShow:!1,checkedShapePopData:{shapeId:null,rows:0,cols:0,startRow:0,startCol:0,orderRow:0,orderCol:0},checkedShape:{shapeId:null,rows:0,cols:0,startRow:0,startCol:0,orderRow:0,orderCol:0},checkedShapeIdx:null,shapeList:[]}},computed:{},watch:{shapeList:{handler:function(e){this.saveAction()},deep:!0},checkedShape:{handler:function(e,t){if(e.shapeId==t.shapeId&&e.cols==t.cols&&e.rows==t.rows)return!1;0==e.cols||0==e.rows?this.checkedShapeShow=!0:this.drawSeatCanvas(e)},deep:!0}},created:function(){c=this,localStorage.getItem("shapeList")&&(this.shapeList=JSON.parse(localStorage.getItem("shapeList")))},mounted:function(){var e=this;this.svg=_svg,this.seatCanvasInit(),this.$nextTick((function(){e.svgInit()}))},beforeDestroy:function(){},methods:{seatCanvasInit:function(){this.seatCanvasWarp.dom=this.$refs.seatCanvasWarp,this.seatCanvasWarp.dom.addEventListener("scroll",this.seatCanvasWarpScroll),this.seatCanvasWarp.offsetLeft=this.seatCanvasWarp.dom.offsetLeft,this.seatCanvasWarp.offsetTop=this.seatCanvasWarp.dom.offsetTop,this.seatCanvas.dom=this.$refs.seatCanvas,this.seatCanvas.ctx=this.$refs.seatCanvas.getContext("2d"),this.seatCanvasBindAction()},seatCanvasBindAction:function(){var e=this.$refs.onlyForAction;e.onmousedown=function(t){c.selectedBox.width=0,c.selectedBox.height=0;var s=t.clientX-c.seatCanvasWarp.offsetLeft-c.seatCanvas.left,a=t.clientY-c.seatCanvasWarp.offsetTop-c.seatCanvas.top,i=[s,a],h=c.seatCanvas.seatWdith+c.seatCanvas.seatMarginRight,o=c.seatCanvas.seatHeight+c.seatCanvas.seatMarginBottom,n=c.checkedShape.cols*h+2*c.seatCanvas.paddingLeft-c.seatCanvas.seatMarginRight,r=c.checkedShape.rows*o+2*c.seatCanvas.paddingTop-c.seatCanvas.seatMarginBottom;e.onmousemove=function(e){var t=e.clientX-s-c.seatCanvasWarp.offsetLeft-c.seatCanvas.left,h=e.clientY-a-c.seatCanvasWarp.offsetTop-c.seatCanvas.top;s+t>n&&(t=n-s),a+h>r&&(h=r-a),c.selectedBox.left=t>0?s:s-Math.abs(t),c.selectedBox.top=h>0?a:a-Math.abs(h),i=[c.selectedBox.left,c.selectedBox.top],Math.abs(t)>20&&Math.abs(h)>20&&(c.selectedBox.width=Math.abs(t),c.selectedBox.height=Math.abs(h))},e.onmouseup=function(t){e.onmousemove=null,e.onmouseup=null,e.onmouseout=null,c.endAction(i,h,o)},e.onmouseout=function(t){e.onmousemove=null,e.onmouseup=null,e.onmouseout=null,c.endAction(i,h,o)}}},endAction:function(e,t,s){if(0==this.selectedBox.width&&0==this.selectedBox.height){for(var a=[],i=0;i<this.checkedShape.cols;i++){for(var h=i*t+this.seatCanvas.paddingLeft,c=0;c<this.checkedShape.rows;c++){var r=c*s+this.seatCanvas.paddingTop,l=[h+this.seatCanvas.seatWdith/2,r+this.seatCanvas.seatHeight/2];if(n["a"].getDisance1(l,e)<this.seatCanvas.seatWdith/2){a=[c,i];break}if(0!=a.length)break}if(0!=a.length)break}if(0==a.length)return!1;var d=a[1]*t+this.seatCanvas.paddingLeft,p=a[0]*s+this.seatCanvas.paddingTop;if(0!=this.selectedSeatList.length){for(var v=-1,u=0;u<this.selectedSeatList.length;u++){var f=this.selectedSeatList[u];if(f.toString()==a.toString()){v=u;break}}-1!=v?(this.seatCanvas.ctx.beginPath(),0==this.checkedShape.seats[a[0]][a[1]].status?this.seatCanvas.ctx.drawImage(this.seatIcon.iconShow,d,p,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight):-1==this.checkedShape.seats[a[0]][a[1]].status&&this.seatCanvas.ctx.drawImage(this.seatIcon.iconNone,d,p,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight),this.$delete(this.selectedSeatList,v)):(this.seatCanvas.ctx.beginPath(),this.seatCanvas.ctx.drawImage(this.seatIcon.iconSelected,d,p,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight),this.selectedSeatList.push(a))}else{this.seatCanvas.seatWdith,this.seatCanvas.seatHeight;0==this.checkedShape.seats[a[0]][a[1]].status?this.checkedShape.seats[a[0]][a[1]].status=-1:this.checkedShape.seats[a[0]][a[1]].status=0,this.seatCanvas.ctx.beginPath(),0==this.checkedShape.seats[a[0]][a[1]].status?this.seatCanvas.ctx.drawImage(this.seatIcon.iconShow,d,p,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight):-1==this.checkedShape.seats[a[0]][a[1]].status&&this.seatCanvas.ctx.drawImage(this.seatIcon.iconNone,d,p,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight),this.checkedShape=this.orderSeats(Object(o["a"])({},this.checkedShape)),this.$set(this.shapeList,this.checkedShapeIdx,Object(o["a"])({},this.checkedShape))}}else{for(var w,g=[e[0]+this.selectedBox.width,e[1]+this.selectedBox.height],m=[],S=0;S<this.checkedShape.cols;S++)for(var k=S*t+this.seatCanvas.paddingLeft,C=0;C<this.checkedShape.rows;C++){var x=C*s+this.seatCanvas.paddingTop,I=[k,x],b=[k+this.seatCanvas.seatWdith,x+this.seatCanvas.seatHeight];I[0]>=e[0]&&I[0]<=g[0]&&b[0]>=e[0]&&b[0]<=g[0]&&I[1]>=e[1]&&I[1]<=g[1]&&b[1]>=e[1]&&b[1]<=g[1]&&(this.seatCanvas.ctx.beginPath(),this.seatCanvas.ctx.drawImage(this.seatIcon.iconSelected,k,x,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight),m.push([C,S]))}(w=this.selectedSeatList).push.apply(w,m)}},checkedRowsOrCols:function(e,t){for(var s,a=[],i=c.seatCanvas.seatWdith+c.seatCanvas.seatMarginRight,h=c.seatCanvas.seatHeight+c.seatCanvas.seatMarginBottom,o=t?e:0,n=t?0:e,r=t?this.checkedShape.cols:this.checkedShape.rows,l=0;l<r;l++){t?n=l:o=l;var d=n*h+c.seatCanvas.paddingTop,p=o*i+c.seatCanvas.paddingLeft,v=!1;c.seatCanvas.ctx.beginPath();for(var u=0;u<c.selectedSeatList.length;u++)if(c.selectedSeatList[u].toString()==[o,n].toString()){v=!0;break}v||(c.seatCanvas.ctx.drawImage(c.seatIcon.iconSelected,d,p,c.seatCanvas.seatWdith,c.seatCanvas.seatHeight),a.push([o,n]))}(s=this.selectedSeatList).push.apply(s,a)},hoverRowsOrCols:function(e,t){var s=this.seatCanvas.seatWdith+this.seatCanvas.seatMarginRight,a=this.seatCanvas.seatHeight+this.seatCanvas.seatMarginBottom;t?(this.hoverPinkBox.width=this.checkedShape.cols*s+2*this.seatCanvas.paddingLeft-this.seatCanvas.seatMarginRight,this.hoverPinkBox.height=this.seatCanvas.seatHeight,this.hoverPinkBox.left=0,this.hoverPinkBox.top=e*a+this.seatCanvas.paddingTop):(this.hoverPinkBox.width=this.seatCanvas.seatWdith,this.hoverPinkBox.height=this.checkedShape.rows*a+2*this.seatCanvas.paddingTop-this.seatCanvas.seatMarginBottom,this.hoverPinkBox.left=e*s+this.seatCanvas.paddingLeft,this.hoverPinkBox.top=0)},cancleSeleced:function(){this.drawSeatCanvas(this.checkedShape)},addSeat:function(){var e=Object(h["a"])(this.checkedShape.seats);this.selectedSeatList.forEach((function(t){e[t[0]][t[1]].status=0})),this.checkedShape.seats=e,this.checkedShape=this.orderSeats(Object(o["a"])({},this.checkedShape)),this.drawSeatCanvas(this.checkedShape),this.$set(this.shapeList,this.checkedShapeIdx,Object(o["a"])({},this.checkedShape))},removeSeat:function(){var e=Object(h["a"])(this.checkedShape.seats);this.selectedSeatList.forEach((function(t){e[t[0]][t[1]].status=-1})),this.checkedShape.seats=e,this.checkedShape=this.orderSeats(Object(o["a"])({},this.checkedShape)),this.drawSeatCanvas(this.checkedShape),this.$set(this.shapeList,this.checkedShapeIdx,Object(o["a"])({},this.checkedShape))},orderSeats:function(e){var t=e.seats;if(0==e.orderCol)for(var s=0,a=0;a<e.rows;a++){for(var i=0,h=0;h<e.cols;h++)-1!=t[a][h].status&&(i+=1);if(0!=i&&(s+=1),0==e.orderRow)for(var o=0,n=0;n<e.cols;n++){var c=t[a][n];c.rowString=e.orderRow+s,-1!=c.status?(o+=1,c.colString=e.orderCol+o):c.colString="-1"}else if(1==e.orderRow)for(var r=-1,l=e.cols-1;l>-1;l--){var d=t[a][l];d.rowString=e.orderRow+s,-1!=d.status?(r+=1,d.colString=e.orderCol+r):d.colString="-1"}}else if(1==e.orderCol)for(var p=-1,v=e.rows-1;v>-1;v--){for(var u=0,f=0;f<e.cols;f++)-1!=t[v][f].status&&(u+=1);if(0!=u&&(p+=1),0==e.orderRow)for(var w=0,g=0;g<e.cols;g++){var m=t[v][g];m.rowString=e.orderRow+p,-1!=m.status?(w+=1,m.colString=e.orderCol+w):m.colString="-1"}else if(1==e.orderRow)for(var S=-1,k=e.cols-1;k>-1;k--){var C=t[v][k];C.rowString=e.orderRow+p,-1!=C.status?(S+=1,C.colString=e.orderCol+S):C.colString="-1"}}return e},drawSeatCanvas:function(e){var t=this;this.selectedBox={width:0,height:0,top:0,left:0},this.selectedSeatList=[],this.seatCanvas.ctx.clearRect(0,0,this.seatCanvas.width,this.seatCanvas.height);var s=this.seatCanvas.seatWdith+this.seatCanvas.seatMarginRight,a=this.seatCanvas.seatHeight+this.seatCanvas.seatMarginBottom;this.seatCanvas.width=e.cols*s+2*this.seatCanvas.paddingLeft-this.seatCanvas.seatMarginRight,this.seatCanvas.height=e.rows*a+2*this.seatCanvas.paddingTop-this.seatCanvas.seatMarginBottom,this.seatCanvas.dom.width=this.seatCanvas.width,this.seatCanvas.dom.height=this.seatCanvas.height,this.seatCanvas.ctx.strokeStyle="green",this.seatCanvas.ctx.lineWidth=2,this.seatCanvas.ctx.beginPath(),this.seatCanvas.ctx.moveTo(this.seatCanvas.width/2,0),this.seatCanvas.ctx.lineTo(this.seatCanvas.width/2,this.seatCanvas.height),this.seatCanvas.ctx.setLineDash([8,10]),this.seatCanvas.ctx.lineCap="round",this.seatCanvas.ctx.stroke(),this.seatCanvas.ctx.closePath(),this.seatCanvas.ctx.beginPath(),this.seatCanvas.ctx.moveTo(0,this.seatCanvas.height/2),this.seatCanvas.ctx.lineTo(this.seatCanvas.width,this.seatCanvas.height/2),this.seatCanvas.ctx.stroke(),this.seatCanvas.ctx.closePath(),this.$nextTick((function(){for(var i=0;i<e.cols;i++)for(var h=i*s+t.seatCanvas.paddingLeft,o=0;o<e.rows;o++){var n=o*a+t.seatCanvas.paddingTop;t.seatCanvas.ctx.beginPath(),0==e.seats[o][i].status?t.seatCanvas.ctx.drawImage(t.seatIcon.iconShow,h,n,t.seatCanvas.seatWdith,t.seatCanvas.seatHeight):-1==e.seats[o][i].status&&t.seatCanvas.ctx.drawImage(t.seatIcon.iconNone,h,n,t.seatCanvas.seatWdith,t.seatCanvas.seatHeight)}}))},seatCanvasWarpScroll:function(){var e=this.$refs.seatCanvasWarp.scrollTop,t=this.$refs.seatCanvasWarp.scrollLeft;this.seatCanvas.left=-t,this.seatCanvas.top=-e},seatCanvasClick:function(e){for(var t=e.clientX-this.seatCanvasWarp.offsetLeft-this.seatCanvas.left,s=e.clientY-this.seatCanvasWarp.offsetTop-this.seatCanvas.top,a=[t,s],i=this.seatCanvas.seatWdith+this.seatCanvas.seatMarginRight,h=this.seatCanvas.seatHeight+this.seatCanvas.seatMarginBottom,o=[],c=0;c<this.checkedShape.cols;c++)for(var r=c*i+this.seatCanvas.paddingLeft,l=0;l<this.checkedShape.rows;l++){var d=l*h+this.seatCanvas.paddingTop,p=[r+this.seatCanvas.seatWdith/2,d+this.seatCanvas.seatHeight/2];if(n["a"].getDisance1(p,a)<this.seatCanvas.seatWdith/2){o=[l,c],0==this.checkedShape.seats[l][c].status?this.checkedShape.seats[l][c].status=-1:this.checkedShape.seats[l][c].status=0,this.seatCanvas.ctx.beginPath(),0==this.checkedShape.seats[l][c].status?this.seatCanvas.ctx.drawImage(this.seatIcon.iconShow,r,d,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight):-1==this.checkedShape.seats[l][c].status&&this.seatCanvas.ctx.drawImage(this.seatIcon.iconNone,r,d,this.seatCanvas.seatWdith,this.seatCanvas.seatHeight),this.shapeList[this.checkedShapeIdx].seats[l][c].status=this.checkedShape.seats[l][c].status;break}if(0!=o.length)break}},svgInit:function(){var e=this;r=this.$refs.svgWarp,l=r.firstElementChild;var t=this.shapeList.map((function(e){return e.shapeId})),s=l.childNodes,a=0;s.forEach((function(s){if(1==s.nodeType&&"text"!=s.nodeName&&"title"!=s.nodeName){var i=++a;s.setAttribute("id",i);var h=t.indexOf(i+"");-1!=h&&e.shapeList[h].rows>0&&e.shapeList[h].cols>0&&(s.style.fill="rgba(255, 192, 203, 0.74)")}}));var i=l.getAttribute("viewBox").split(" ");this.center={find:!0,x:parseFloat(i[2])/2,y:parseFloat(i[3])/2};var h=this.$refs.content.clientWidth,o=this.$refs.content.clientHeight;l.setAttribute("width",h),l.setAttribute("height",o),l.addEventListener("click",c.shapeCheckedAction),this.seatIconInit()},shapeCheckedAction:function(e){var t=e.target,s=t.nodeName;if("path"!=s&&"rect"!=s&&"polygon"!=s)return!1;var a=[],i=t.getAttribute("id"),h=this.shapeList.map((function(e){return e.shapeId}));if(-1==h.indexOf(i)){var c=null;switch(s){case"path":c=n["a"].pathDecompose([this.center.x,this.center.y],t.getAttribute("d"));break;case"polygon":c=n["a"].polygonDecompose([this.center.x,this.center.y],t.getAttribute("points"));break;case"rect":var r=t.getAttribute("width"),l=t.getAttribute("height"),d=t.getAttribute("x"),p=t.getAttribute("y");c=n["a"].rectDecompose([this.center.x,this.center.y],d,p,r,l);break;default:console.log(s);break}if(null==c)return!1;a=Object(o["a"])({},c,{shapeId:i,rows:0,cols:0,startRow:1,startCol:1,orderRow:0,orderCol:0,seats:[]}),this.toggleCheckedShapeStatus(Object(o["a"])({},a),Object(o["a"])({},this.checkedShape)),this.checkedShapeShow=!0,this.checkedShapePopData=Object(o["a"])({},a)}else{var v=h.indexOf(i);if(a=JSON.parse(JSON.stringify(this.shapeList[v])),this.checkedShape.shapeId!=a.shapeId){this.toggleCheckedShapeStatus(a,Object(o["a"])({},this.checkedShape)),this.checkedShape=a;var u=this.shapeList.map((function(e){return e.shapeId}));return this.checkedShapeIdx=u.indexOf(i),!1}}},toggleCheckedShapeStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&t.shapeId){if(e.shapeId==t.shapeId)return!1;document.getElementById(t.shapeId).style.stroke="#333",document.getElementById(t.shapeId).style.strokeWidth=1}e&&(document.getElementById(e.shapeId).style.strokeWidth=16,document.getElementById(e.shapeId).style.stroke="green",document.getElementById("500").setAttribute("style","transform: rotate("+e.angle+"deg);transform-origin: 50% 50%;"))},checkedShapeSeatComfrim:function(){if(this.checkedShapePopData.cols<1||this.checkedShapePopData.rows<1)return alert("行和列必须都大于0"),!1;this.checkedShapeShow=!1;for(var e=Object(o["a"])({},this.checkedShapePopData),t=[],s=0,a={seatId:"",status:0,rowString:"",colString:"",level:0},i=0;i<e.rows;i++){for(var h=[],n=0;n<e.cols;n++)a.seatId=c+s++,a.colString=e.orderCol+n,h.push(Object(o["a"])({},a));t.push(h)}e.seats=t,e=this.orderSeats(Object(o["a"])({},e));var c=e.shapeId,r=this.shapeList.map((function(e){return e.shapeId})),l=r.indexOf(c);-1!=l?this.$set(this.shapeList,l,Object(o["a"])({},e)):(this.shapeList.push(Object(o["a"])({},e)),document.getElementById(c).style.fill="rgba(255, 192, 203, 0.74)"),this.checkedShape=Object(o["a"])({},e)},toChangeShapeInfo:function(){null==this.checkedShape.shapeId?alert("请先选择shape"):(this.checkedShapeShow=!0,this.checkedShapePopData=Object(o["a"])({},this.checkedShape))},checkedShapeSeatCancle:function(){this.checkedShapeShow=!1,this.toggleCheckedShapeStatus(null!=this.checkedShape.shapeId&&this.checkedShape,Object(o["a"])({},this.checkedShapePopData))},seatIconInit:function(){this.seatIcon.iconShow=this.$refs.iconShow,this.seatIcon.iconNone=this.$refs.iconNone,this.seatIcon.iconSelected=this.$refs.iconSelected},saveAction:function(){localStorage.setItem("shapeList",JSON.stringify(this.shapeList))},floatTwo:function(e){return Math.floor(1e4*e)/1e4}}},p=d,v=(s("c3b9"),s("2877")),u=Object(v["a"])(p,a,i,!1,null,"f6cd243e",null);t["a"]=u.exports},c5c6:function(e,t,s){e.exports=s.p+"img/seat_icon_checked.2dd3db1f.svg"},c8f9:function(e,t,s){},d1ad:function(e,t,s){}}]);
//# sourceMappingURL=chunk-98a9de5e.b0a87ef6.js.map